#!/bin/bash
## or
#!/bin/ksh
## or
#!/bin/zsh
## -*- encoding: utf-8 -*-
##
## ＿人人人人人人＿
## ＞　突然の死　＜ ジェネレーター
## ￣Y^Y^Y^Y^Y￣
## Copyright (C) 2013 SATOH Fumiyasu @ OSS Technology Corp., Japan
##               <https://github.com/fumiyas/home-commands/blob/master/echo-sd>
##               <https://twitter.com/satoh_fumiyasu>
##               <http://www.OSSTech.co.jp/>
##
## License: GNU General Public License version 3
##
## How to install:
##
##   $ mkdir -p $HOME/bin
##   $ cd $HOME/bin
##   $ wget -q https://raw.github.com/fumiyas/home-commands/master/echo-sd
##   $ chmod +x echo-sd
##   $ export PATH="$HOME/bin:$PATH"
##
## Examples:
##
##   $ echo-sd
##   ＿人人人人人人＿
##   ＞　突然の死　＜
##   ￣Y^Y^Y^Y^Y^Y^￣
##   $ echo-sd 仕事しろ！!
##   ＿人人人人人人人人＿
##   ＞　仕事しろ！！　＜
##   ￣Y^Y^Y^Y^Y^YY^^Y^￣
##
##   $ echo-sd -v ガッ！
##   ＿人人人＿
##   ＞　　　＜
##   ＞　ガ　＜
##   ＞　ッ　＜
##   ＞　！　＜
##   ＞　　　＜
##   ￣Y^Y^Y^￣
##
## TODO:
##
##   * 縦書きモードでも複数行のセリフ対応
##

set -u
export LC_ALL="ja_JP.UTF-8"

if [[ ${1-} = -h ]]; then
  echo "Usage: echo-sd [-v] [script]"
  exit 0
fi

if [[ ${1-} = -v ]]; then
  vertical="set"
  shift
fi

script="${1-突然の死}"

if [[ -z ${vertical-} ]]; then
  template="${script//[ -~]/ }"
  template="${template//[! ]/  }"

  header="＿人${template//  /人}人＿"
  footer="￣Y^${template//  /Y^}Y^￣"

  echo "${header/ /}"
  echo "＞　${script}　＜"
  echo "${footer/ /}"
else
  script="　${script}　"
  template="${script//./?}"
  echo "＿人人人＿"
  while [[ -n $script ]]; do
    template="${template#?}"
    echo "＞　${script%$template}　＜"
    script="${script#?}"
  done
  echo "￣Y^Y^Y^￣"
fi

exit 0

